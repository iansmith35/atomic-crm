<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Production Studio - AI Producer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
    <style>
        .waveform {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            height: 4px;
            animation: pulse 2s ease-in-out infinite alternate;
        }
        @keyframes pulse {
            from { opacity: 0.5; }
            to { opacity: 1; }
        }
        .studio-control {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            border: 1px solid #4b5563;
        }
        .recording-light {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ef4444;
            animation: blink 1s ease-in-out infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        .track {
            background: linear-gradient(90deg, #111827 0%, #1f2937 100%);
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div class="max-w-7xl mx-auto p-6">
        <!-- Header -->
        <div class="bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl p-6 mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold flex items-center">
                        üéµ Music Production Studio - AI Producer
                    </h1>
                    <p class="text-purple-100 mt-2">Professional music creation with AI assistance & real production tools</p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold" id="activeProjectsCount">3</div>
                    <div class="text-sm text-purple-200">Active Projects</div>
                </div>
            </div>
        </div>

        <div class="grid lg:grid-cols-3 gap-8">
            <!-- AI Music Producer Chat -->
            <div class="lg:col-span-1 bg-gray-800 rounded-xl p-6">
                <h2 class="text-xl font-bold mb-4 flex items-center">ü§ñ AI Producer Bot</h2>
                <div id="aiProducerChat" class="bg-gray-700 rounded-lg p-4 h-64 overflow-y-auto mb-4">
                    <div class="text-purple-400 mb-2">
                        <strong>AI Producer:</strong> Welcome to the studio! I can help you create beats, melodies, and full compositions. What style of music are we making today?
                    </div>
                </div>
                <div class="flex mb-4">
                    <input type="text" id="aiInput" placeholder="Ask the AI Producer..." 
                           class="flex-1 bg-gray-700 rounded-l-lg px-3 py-2 text-white text-sm">
                    <button onclick="chatWithAI()" 
                            class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-r-lg text-sm">
                        Send
                    </button>
                </div>
                
                <!-- Quick AI Actions -->
                <div class="space-y-2">
                    <h3 class="font-semibold mb-2">‚ö° Quick AI Actions</h3>
                    <button onclick="generateBeat()" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded text-sm">ü•Å Generate Beat</button>
                    <button onclick="generateMelody()" class="w-full bg-green-600 hover:bg-green-700 py-2 rounded text-sm">üéπ Create Melody</button>
                    <button onclick="generateBaseline()" class="w-full bg-red-600 hover:bg-red-700 py-2 rounded text-sm">üé∏ Add Baseline</button>
                    <button onclick="aiMixMaster()" class="w-full bg-yellow-600 hover:bg-yellow-700 py-2 rounded text-sm">üéõÔ∏è AI Mix Master</button>
                </div>
            </div>

            <!-- Studio Controls -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Transport Controls -->
                <div class="bg-gray-800 rounded-xl p-6">
                    <h2 class="text-xl font-bold mb-4">üéõÔ∏è Studio Transport</h2>
                    <div class="flex items-center justify-center space-x-4 mb-6">
                        <button id="recordBtn" onclick="toggleRecord()" class="studio-control p-4 rounded-full hover:bg-red-600 transition-colors">
                            <div class="recording-light mr-2 inline-block" id="recordLight" style="display: none;"></div>
                            ‚è∫Ô∏è REC
                        </button>
                        <button id="playBtn" onclick="togglePlay()" class="studio-control p-4 rounded-full hover:bg-green-600 transition-colors">
                            ‚ñ∂Ô∏è PLAY
                        </button>
                        <button onclick="stopPlayback()" class="studio-control p-4 rounded-full hover:bg-gray-600 transition-colors">
                            ‚èπÔ∏è STOP
                        </button>
                        <button onclick="pausePlayback()" class="studio-control p-4 rounded-full hover:bg-yellow-600 transition-colors">
                            ‚è∏Ô∏è PAUSE
                        </button>
                    </div>

                    <!-- Timeline/Waveform -->
                    <div class="bg-gray-700 rounded-lg p-4 mb-4">
                        <div class="flex justify-between text-xs text-gray-400 mb-2">
                            <span>00:00</span>
                            <span id="currentTime">00:00</span>
                            <span id="totalTime">03:45</span>
                        </div>
                        <div class="bg-gray-600 rounded-full h-2 mb-2">
                            <div id="progressBar" class="waveform rounded-full h-full" style="width: 0%"></div>
                        </div>
                        <div class="text-center text-sm text-gray-400">
                            BPM: <span id="bpmDisplay">120</span> | Key: <span id="keyDisplay">C Major</span>
                        </div>
                    </div>
                </div>

                <!-- Multi-Track Mixer -->
                <div class="bg-gray-800 rounded-xl p-6">
                    <h2 class="text-xl font-bold mb-4">üéöÔ∏è Multi-Track Mixer</h2>
                    <div class="grid grid-cols-4 gap-4">
                        <!-- Track 1 - Drums -->
                        <div class="track p-4 rounded-lg">
                            <h3 class="font-bold mb-2 text-sm">ü•Å Drums</h3>
                            <input type="range" id="drumVolume" min="0" max="100" value="80" class="w-full mb-2" onchange="adjustVolume('drums', this.value)">
                            <div class="text-xs text-gray-400 mb-2">Vol: <span id="drumVol">80</span>%</div>
                            <button onclick="muteTrack('drums')" class="w-full bg-red-600 hover:bg-red-700 py-1 rounded text-xs" id="drumMute">MUTE</button>
                            <button onclick="soloTrack('drums')" class="w-full bg-yellow-600 hover:bg-yellow-700 py-1 rounded text-xs mt-1" id="drumSolo">SOLO</button>
                        </div>

                        <!-- Track 2 - Bass -->
                        <div class="track p-4 rounded-lg">
                            <h3 class="font-bold mb-2 text-sm">üé∏ Bass</h3>
                            <input type="range" id="bassVolume" min="0" max="100" value="75" class="w-full mb-2" onchange="adjustVolume('bass', this.value)">
                            <div class="text-xs text-gray-400 mb-2">Vol: <span id="bassVol">75</span>%</div>
                            <button onclick="muteTrack('bass')" class="w-full bg-red-600 hover:bg-red-700 py-1 rounded text-xs" id="bassMute">MUTE</button>
                            <button onclick="soloTrack('bass')" class="w-full bg-yellow-600 hover:bg-yellow-700 py-1 rounded text-xs mt-1" id="bassSolo">SOLO</button>
                        </div>

                        <!-- Track 3 - Melody -->
                        <div class="track p-4 rounded-lg">
                            <h3 class="font-bold mb-2 text-sm">üéπ Melody</h3>
                            <input type="range" id="melodyVolume" min="0" max="100" value="85" class="w-full mb-2" onchange="adjustVolume('melody', this.value)">
                            <div class="text-xs text-gray-400 mb-2">Vol: <span id="melodyVol">85</span>%</div>
                            <button onclick="muteTrack('melody')" class="w-full bg-red-600 hover:bg-red-700 py-1 rounded text-xs" id="melodyMute">MUTE</button>
                            <button onclick="soloTrack('melody')" class="w-full bg-yellow-600 hover:bg-yellow-700 py-1 rounded text-xs mt-1" id="melodySolo">SOLO</button>
                        </div>

                        <!-- Track 4 - Vocals -->
                        <div class="track p-4 rounded-lg">
                            <h3 class="font-bold mb-2 text-sm">üé§ Vocals</h3>
                            <input type="range" id="vocalVolume" min="0" max="100" value="90" class="w-full mb-2" onchange="adjustVolume('vocal', this.value)">
                            <div class="text-xs text-gray-400 mb-2">Vol: <span id="vocalVol">90</span>%</div>
                            <button onclick="muteTrack('vocal')" class="w-full bg-red-600 hover:bg-red-700 py-1 rounded text-xs" id="vocalMute">MUTE</button>
                            <button onclick="soloTrack('vocal')" class="w-full bg-yellow-600 hover:bg-yellow-700 py-1 rounded text-xs mt-1" id="vocalSolo">SOLO</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Management Section -->
        <div class="grid lg:grid-cols-2 gap-8 mt-8">
            <!-- Upload/Download Files -->
            <div class="bg-gray-800 rounded-xl p-6">
                <h2 class="text-xl font-bold mb-4">üìÅ File Management</h2>
                
                <!-- Upload Section -->
                <div class="mb-6">
                    <h3 class="font-semibold mb-3">‚¨ÜÔ∏è Upload Files</h3>
                    <div class="border-2 border-dashed border-gray-600 rounded-lg p-6 text-center">
                        <input type="file" id="fileUpload" multiple accept="audio/*" class="hidden" onchange="handleFileUpload(event)">
                        <button onclick="document.getElementById('fileUpload').click()" class="w-full bg-blue-600 hover:bg-blue-700 py-3 rounded-lg">
                            üì§ Upload Recordings/Tracks
                        </button>
                        <p class="text-sm text-gray-400 mt-2">Drag & drop or click to upload audio files</p>
                    </div>
                </div>

                <!-- File Library -->
                <div>
                    <h3 class="font-semibold mb-3">üéµ Audio Library</h3>
                    <div id="fileLibrary" class="space-y-2 max-h-64 overflow-y-auto">
                        <!-- Sample files will be added here -->
                        <div class="bg-gray-700 rounded p-3 flex justify-between items-center">
                            <span class="text-sm">üéµ Demo_Beat_120bpm.mp3</span>
                            <div class="space-x-2">
                                <button onclick="playPreview('demo1')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs">‚ñ∂Ô∏è</button>
                                <button onclick="downloadFile('demo1')" class="bg-purple-600 hover:bg-purple-700 px-2 py-1 rounded text-xs">‚¨áÔ∏è</button>
                            </div>
                        </div>
                        <div class="bg-gray-700 rounded p-3 flex justify-between items-center">
                            <span class="text-sm">üé∏ Bass_Line_Funk.wav</span>
                            <div class="space-x-2">
                                <button onclick="playPreview('demo2')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs">‚ñ∂Ô∏è</button>
                                <button onclick="downloadFile('demo2')" class="bg-purple-600 hover:bg-purple-700 px-2 py-1 rounded text-xs">‚¨áÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Studio Projects -->
            <div class="bg-gray-800 rounded-xl p-6">
                <h2 class="text-xl font-bold mb-4">üéº Studio Projects</h2>
                
                <!-- Current Project -->
                <div class="mb-6">
                    <h3 class="font-semibold mb-3">üìÄ Current Project</h3>
                    <div class="bg-gray-700 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold">Untitled Project</span>
                            <span class="text-sm text-gray-400">Last saved: 2 min ago</span>
                        </div>
                        <div class="text-sm text-gray-400 mb-3">4 tracks ‚Ä¢ 3:45 duration ‚Ä¢ 120 BPM</div>
                        <div class="flex space-x-2">
                            <button onclick="saveProject()" class="bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-sm flex-1">üíæ Save</button>
                            <button onclick="exportProject()" class="bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm flex-1">üì§ Export</button>
                        </div>
                    </div>
                </div>

                <!-- Project Library -->
                <div>
                    <h3 class="font-semibold mb-3">üìö Project Library</h3>
                    <div class="space-y-2 max-h-48 overflow-y-auto">
                        <div class="bg-gray-700 rounded p-3 flex justify-between items-center">
                            <div>
                                <div class="font-semibold text-sm">üéµ Summer Vibes</div>
                                <div class="text-xs text-gray-400">Hip-hop ‚Ä¢ 8 tracks</div>
                            </div>
                            <button onclick="loadProject('summer')" class="bg-purple-600 hover:bg-purple-700 px-2 py-1 rounded text-xs">üìÇ Load</button>
                        </div>
                        <div class="bg-gray-700 rounded p-3 flex justify-between items-center">
                            <div>
                                <div class="font-semibold text-sm">üé∏ Rock Anthem</div>
                                <div class="text-xs text-gray-400">Rock ‚Ä¢ 6 tracks</div>
                            </div>
                            <button onclick="loadProject('rock')" class="bg-purple-600 hover:bg-purple-700 px-2 py-1 rounded text-xs">üìÇ Load</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Effects and Processing -->
        <div class="bg-gray-800 rounded-xl p-6 mt-8">
            <h2 class="text-xl font-bold mb-4">üéõÔ∏è Effects & Processing</h2>
            <div class="grid md:grid-cols-4 gap-4">
                <!-- Reverb -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-sm">üåä Reverb</h3>
                    <label class="block text-xs text-gray-400 mb-1">Room Size</label>
                    <input type="range" id="reverbSize" min="0" max="100" value="30" class="w-full mb-2" onchange="updateEffect('reverb', 'size', this.value)">
                    <label class="block text-xs text-gray-400 mb-1">Wet/Dry</label>
                    <input type="range" id="reverbWet" min="0" max="100" value="20" class="w-full" onchange="updateEffect('reverb', 'wet', this.value)">
                </div>

                <!-- Delay -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-sm">‚è∞ Delay</h3>
                    <label class="block text-xs text-gray-400 mb-1">Time (ms)</label>
                    <input type="range" id="delayTime" min="0" max="1000" value="250" class="w-full mb-2" onchange="updateEffect('delay', 'time', this.value)">
                    <label class="block text-xs text-gray-400 mb-1">Feedback</label>
                    <input type="range" id="delayFeedback" min="0" max="100" value="15" class="w-full" onchange="updateEffect('delay', 'feedback', this.value)">
                </div>

                <!-- Distortion -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-sm">üî• Distortion</h3>
                    <label class="block text-xs text-gray-400 mb-1">Drive</label>
                    <input type="range" id="distDrive" min="0" max="100" value="0" class="w-full mb-2" onchange="updateEffect('distortion', 'drive', this.value)">
                    <label class="block text-xs text-gray-400 mb-1">Level</label>
                    <input type="range" id="distLevel" min="0" max="100" value="50" class="w-full" onchange="updateEffect('distortion', 'level', this.value)">
                </div>

                <!-- Filter -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-sm">üéõÔ∏è Filter</h3>
                    <label class="block text-xs text-gray-400 mb-1">Frequency</label>
                    <input type="range" id="filterFreq" min="100" max="10000" value="5000" class="w-full mb-2" onchange="updateEffect('filter', 'frequency', this.value)">
                    <label class="block text-xs text-gray-400 mb-1">Resonance</label>
                    <input type="range" id="filterRes" min="0" max="100" value="10" class="w-full" onchange="updateEffect('filter', 'resonance', this.value)">
                </div>
            </div>
        </div>

        <!-- Back Button -->
        <div class="mt-8 text-center">
            <a href="index.html" class="inline-block bg-gray-700 hover:bg-gray-600 px-6 py-3 rounded-lg font-semibold">
                ‚Üê Back to Office Dashboard
            </a>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
        // Initialize Web Audio API
        let audioContext;
        let isRecording = false;
        let isPlaying = false;
        let currentTime = 0;
        let totalTime = 225; // 3:45 in seconds
        let playInterval;

        // Track states
        const trackStates = {
            drums: { volume: 80, muted: false, solo: false },
            bass: { volume: 75, muted: false, solo: false },
            melody: { volume: 85, muted: false, solo: false },
            vocal: { volume: 90, muted: false, solo: false }
        };

        // Initialize audio context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Chat with AI Producer
        function chatWithAI() {
            const input = document.getElementById('aiInput');
            const chat = document.getElementById('aiProducerChat');
            const message = input.value.trim();
            
            if (!message) return;
            
            chat.innerHTML += `<div class="mb-2"><strong>You:</strong> ${message}</div>`;
            
            setTimeout(() => {
                const responses = [
                    "Great idea! I can create a beat in that style. Let me generate some options for you.",
                    "Perfect! I'll add some harmonic layers to complement your melody. Give me a moment to process...",
                    "That's an interesting direction. I can help with the arrangement and suggest some complementary instruments.",
                    "I've analyzed your track and can suggest some improvements to the mix. Let me show you what I can do.",
                    "Excellent choice! I'll create a backing track that fits your vision. This will sound amazing!",
                    "I can help with that sound design. Let me generate some options using AI synthesis techniques.",
                    "That's a creative approach! I'll use machine learning to generate variations of your theme."
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                chat.innerHTML += `<div class="text-purple-400 mb-2"><strong>AI Producer:</strong> ${response}</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 1000);
            
            input.value = '';
            chat.scrollTop = chat.scrollHeight;
        }

        // Transport Controls
        function toggleRecord() {
            initAudio();
            isRecording = !isRecording;
            const recordBtn = document.getElementById('recordBtn');
            const recordLight = document.getElementById('recordLight');
            
            if (isRecording) {
                recordBtn.innerHTML = '<div class="recording-light mr-2 inline-block"></div>‚è∫Ô∏è RECORDING';
                recordBtn.classList.add('bg-red-600');
                recordLight.style.display = 'inline-block';
                navigator.mediaDevices.getUserMedia({ audio: true })
                    .then(stream => {
                        console.log('Recording started');
                        // Here you would implement actual recording logic
                    })
                    .catch(err => console.log('Microphone access denied'));
            } else {
                recordBtn.innerHTML = '‚è∫Ô∏è REC';
                recordBtn.classList.remove('bg-red-600');
                recordLight.style.display = 'none';
                console.log('Recording stopped');
            }
        }

        function togglePlay() {
            initAudio();
            isPlaying = !isPlaying;
            const playBtn = document.getElementById('playBtn');
            
            if (isPlaying) {
                playBtn.innerHTML = '‚è∏Ô∏è PAUSE';
                playBtn.classList.add('bg-green-600');
                startPlayback();
            } else {
                playBtn.innerHTML = '‚ñ∂Ô∏è PLAY';
                playBtn.classList.remove('bg-green-600');
                stopPlayback();
            }
        }

        function stopPlayback() {
            isPlaying = false;
            currentTime = 0;
            clearInterval(playInterval);
            document.getElementById('playBtn').innerHTML = '‚ñ∂Ô∏è PLAY';
            document.getElementById('playBtn').classList.remove('bg-green-600');
            updateTimeDisplay();
        }

        function pausePlayback() {
            isPlaying = false;
            clearInterval(playInterval);
            document.getElementById('playBtn').innerHTML = '‚ñ∂Ô∏è PLAY';
            document.getElementById('playBtn').classList.remove('bg-green-600');
        }

        function startPlayback() {
            playInterval = setInterval(() => {
                currentTime += 0.1;
                if (currentTime >= totalTime) {
                    stopPlayback();
                }
                updateTimeDisplay();
            }, 100);
        }

        function updateTimeDisplay() {
            const minutes = Math.floor(currentTime / 60);
            const seconds = Math.floor(currentTime % 60);
            document.getElementById('currentTime').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            const progress = (currentTime / totalTime) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        // Track Controls
        function adjustVolume(track, value) {
            trackStates[track].volume = value;
            document.getElementById(`${track}Vol`).textContent = value;
            // Here you would adjust actual audio volume
        }

        function muteTrack(track) {
            trackStates[track].muted = !trackStates[track].muted;
            const btn = document.getElementById(`${track}Mute`);
            if (btn && trackStates[track].muted) {
                btn.classList.add('bg-red-800');
                btn.textContent = 'UNMUTE';
            } else if (btn) {
                btn.classList.remove('bg-red-800');
                btn.textContent = 'MUTE';
            }
        }

        function soloTrack(track) {
            trackStates[track].solo = !trackStates[track].solo;
            const btn = document.getElementById(`${track}Solo`);
            if (btn && trackStates[track].solo) {
                btn.classList.add('bg-yellow-800');
                btn.textContent = 'UNSOLO';
            } else if (btn) {
                btn.classList.remove('bg-yellow-800');
                btn.textContent = 'SOLO';
            }
        }

        // AI Generation Functions
        function generateBeat() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-purple-400 mb-2"><strong>AI Producer:</strong> ü•Å Generating a fresh beat... Analyzing rhythm patterns and creating a 120 BPM drum sequence!</div>`;
            chat.scrollTop = chat.scrollHeight;
            
            // Simulate beat generation with Tone.js
            setTimeout(() => {
                if (typeof Tone !== 'undefined') {
                    const synth = new Tone.MembraneSynth().toDestination();
                    const pattern = ["C2", null, "C2", null, "C2", null, "C2", "C2"];
                    let index = 0;
                    
                    const repeat = (time) => {
                        if (pattern[index % 8]) {
                            synth.triggerAttackRelease(pattern[index % 8], "8n", time);
                        }
                        index++;
                        if (index >= 16) index = 0;
                    };
                    
                    Tone.Transport.scheduleRepeat(repeat, "8n");
                    Tone.Transport.start();
                    
                    setTimeout(() => {
                        Tone.Transport.stop();
                        Tone.Transport.cancel();
                        chat.innerHTML += `<div class="text-green-400 mb-2"><strong>AI Producer:</strong> ‚úÖ Beat generated! Added to drums track.</div>`;
                        chat.scrollTop = chat.scrollHeight;
                    }, 4000);
                }
            }, 1500);
        }

        function generateMelody() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-purple-400 mb-2"><strong>AI Producer:</strong> üéπ Creating a melodic sequence... Using AI to generate harmonically rich progressions!</div>`;
            chat.scrollTop = chat.scrollHeight;
            
            setTimeout(() => {
                if (typeof Tone !== 'undefined') {
                    const synth = new Tone.Synth().toDestination();
                    const melody = ["C4", "E4", "G4", "B4", "C5", "G4", "E4", "C4"];
                    let index = 0;
                    
                    const repeat = (time) => {
                        synth.triggerAttackRelease(melody[index % 8], "4n", time);
                        index++;
                        if (index >= 16) index = 0;
                    };
                    
                    Tone.Transport.scheduleRepeat(repeat, "4n");
                    Tone.Transport.start();
                    
                    setTimeout(() => {
                        Tone.Transport.stop();
                        Tone.Transport.cancel();
                        chat.innerHTML += `<div class="text-green-400 mb-2"><strong>AI Producer:</strong> ‚úÖ Melody created! Added to melody track with perfect harmony.</div>`;
                        chat.scrollTop = chat.scrollHeight;
                    }, 6000);
                }
            }, 1500);
        }

        function generateBaseline() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-purple-400 mb-2"><strong>AI Producer:</strong> üé∏ Crafting a groovy baseline... AI analyzing chord progressions for the perfect foundation!</div>`;
            chat.scrollTop = chat.scrollHeight;
            
            setTimeout(() => {
                chat.innerHTML += `<div class="text-green-400 mb-2"><strong>AI Producer:</strong> ‚úÖ Baseline generated! Deep, punchy bass line added to complement your track.</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 2000);
        }

        function aiMixMaster() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-purple-400 mb-2"><strong>AI Producer:</strong> üéõÔ∏è AI Mix Master activated! Analyzing frequency spectrum and optimizing levels, EQ, and spatial positioning...</div>`;
            chat.scrollTop = chat.scrollHeight;
            
            setTimeout(() => {
                chat.innerHTML += `<div class="text-green-400 mb-2"><strong>AI Producer:</strong> ‚úÖ Professional mix complete! Your track now has radio-ready polish with perfect balance.</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 3000);
        }

        // File Management
        function handleFileUpload(event) {
            const files = event.target.files;
            const library = document.getElementById('fileLibrary');
            
            for (let file of files) {
                if (file.type.startsWith('audio/')) {
                    const fileDiv = document.createElement('div');
                    fileDiv.className = 'bg-gray-700 rounded p-3 flex justify-between items-center';
                    fileDiv.innerHTML = `
                        <span class="text-sm">üéµ ${file.name}</span>
                        <div class="space-x-2">
                            <button onclick="playPreview('${file.name}')" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs">‚ñ∂Ô∏è</button>
                            <button onclick="downloadFile('${file.name}')" class="bg-purple-600 hover:bg-purple-700 px-2 py-1 rounded text-xs">‚¨áÔ∏è</button>
                        </div>
                    `;
                    library.appendChild(fileDiv);
                }
            }
            
            // Upload to Supabase (simulated)
            uploadToSupabase(files);
        }

        async function uploadToSupabase(files) {
            try {
                // Simulate upload to Supabase
                const chat = document.getElementById('aiProducerChat');
                chat.innerHTML += `<div class="text-blue-400 mb-2"><strong>System:</strong> üì§ Uploading ${files.length} file(s) to cloud storage...</div>`;
                
                setTimeout(() => {
                    chat.innerHTML += `<div class="text-green-400 mb-2"><strong>System:</strong> ‚úÖ Files uploaded successfully to Supabase storage!</div>`;
                    chat.scrollTop = chat.scrollHeight;
                }, 2000);
            } catch (error) {
                console.error('Upload error:', error);
            }
        }

        function playPreview(filename) {
            console.log(`Playing preview: ${filename}`);
            // Here you would implement audio preview functionality
        }

        function downloadFile(filename) {
            console.log(`Downloading: ${filename}`);
            // Here you would implement download functionality
        }

        // Project Management
        function saveProject() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-blue-400 mb-2"><strong>System:</strong> üíæ Saving project to Supabase database...</div>`;
            
            setTimeout(() => {
                chat.innerHTML += `<div class="text-green-400 mb-2"><strong>System:</strong> ‚úÖ Project saved successfully!</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 1500);
        }

        function exportProject() {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-blue-400 mb-2"><strong>System:</strong> üì§ Exporting project as high-quality WAV file...</div>`;
            
            setTimeout(() => {
                chat.innerHTML += `<div class="text-green-400 mb-2"><strong>System:</strong> ‚úÖ Project exported! Ready for download.</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 2500);
        }

        function loadProject(projectId) {
            const chat = document.getElementById('aiProducerChat');
            chat.innerHTML += `<div class="text-blue-400 mb-2"><strong>System:</strong> üìÇ Loading project from database...</div>`;
            
            setTimeout(() => {
                chat.innerHTML += `<div class="text-green-400 mb-2"><strong>System:</strong> ‚úÖ Project loaded successfully!</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 1000);
        }

        // Effects
        function updateEffect(effectType, parameter, value) {
            console.log(`Updating ${effectType} ${parameter}: ${value}`);
            // Here you would update actual audio effects
        }

        // Enter key support for AI chat
        document.getElementById('aiInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                chatWithAI();
            }
        });

        // Load studio data from Supabase
        async function loadStudioData() {
            try {
                const response = await api.call('musicStudio', '/status');
                if (response && response.success) {
                    document.getElementById('activeProjectsCount').textContent = response.active_projects || 3;
                }
            } catch (error) {
                console.log('Using simulated data');
            }
        }

        // Initialize
        loadStudioData();
        
        // Initialize Tone.js when user first interacts
        document.addEventListener('click', () => {
            if (typeof Tone !== 'undefined' && Tone.context.state !== 'running') {
                Tone.start();
            }
        }, { once: true });
    </script>
</body>
</html>