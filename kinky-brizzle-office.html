<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KinkyBrizzle Office - AI Brand Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="printful-config.js"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div class="max-w-6xl mx-auto p-6">
        <!-- Header -->
        <div class="bg-gradient-to-r from-pink-500 to-rose-600 rounded-xl p-6 mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold flex items-center">
                        üé≠ KinkyBrizzle Office - AI Brand Management
                    </h1>
                    <p class="text-pink-100 mt-2">Adult brand management with Printful.com fulfillment & AI automation</p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold" id="activeOrders">23</div>
                    <div class="text-sm text-pink-200">Active Orders</div>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
            <!-- Product Management Dashboard -->
            <div class="md:col-span-2 bg-gray-800 rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">üõçÔ∏è Product & Order Management</h2>
                    <div class="flex space-x-2">
                        <button onclick="showProductCatalog()" class="px-3 py-1 bg-pink-600 rounded text-sm">Products</button>
                        <button onclick="showOrderQueue()" class="px-3 py-1 bg-rose-600 rounded text-sm">Orders</button>
                        <button onclick="showInventory()" class="px-3 py-1 bg-purple-600 rounded text-sm">Inventory</button>
                    </div>
                </div>
                
                <div id="managementPanel" class="space-y-3 max-h-96 overflow-y-auto">
                    <!-- Active Orders -->
                    <div class="order-item bg-gray-700 rounded-lg p-4 border-l-4 border-green-500">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-green-400">üì¶</span>
                                <span class="font-semibold">Order #KB-2024-001</span>
                                <span class="bg-green-600 text-xs px-2 py-1 rounded">Processing</span>
                            </div>
                            <span class="text-xs text-gray-400">5 min ago</span>
                        </div>
                        <div class="text-sm text-gray-300 mb-3">
                            Customer: Sarah M. ‚Ä¢ Item: Premium T-Shirt ‚Ä¢ Qty: 2 ‚Ä¢ $45.99
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="processOrder('KB-2024-001')" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm">‚úÖ Process</button>
                            <button onclick="viewOrderDetails('KB-2024-001')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">üëÅÔ∏è View</button>
                        </div>
                    </div>

                    <!-- Product Alert -->
                    <div class="order-item bg-gray-700 rounded-lg p-4 border-l-4 border-yellow-500">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-yellow-400">‚ö†Ô∏è</span>
                                <span class="font-semibold">Low Stock Alert</span>
                                <span class="bg-yellow-600 text-xs px-2 py-1 rounded">Inventory</span>
                            </div>
                            <span class="text-xs text-gray-400">10 min ago</span>
                        </div>
                        <div class="text-sm text-gray-300 mb-3">
                            Premium Hoodie (Black, L) - Only 3 remaining ‚Ä¢ Reorder threshold: 5 units
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="reorderProduct('hoodie-black-l')" class="bg-yellow-600 hover:bg-yellow-700 px-3 py-1 rounded text-sm">üîÑ Reorder</button>
                            <button onclick="updateThreshold('hoodie-black-l')" class="bg-orange-600 hover:bg-orange-700 px-3 py-1 rounded text-sm">‚öôÔ∏è Settings</button>
                        </div>
                    </div>

                    <!-- Printful Integration Status -->
                    <div class="order-item bg-gray-700 rounded-lg p-4 border-l-4 border-blue-500">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-blue-400">üè≠</span>
                                <span class="font-semibold">Printful Sync Status</span>
                                <span class="bg-blue-600 text-xs px-2 py-1 rounded">API</span>
                            </div>
                            <span class="text-xs text-gray-400">Just now</span>
                        </div>
                        <div class="text-sm text-gray-300 mb-3">
                            ‚úÖ Connected ‚Ä¢ Last sync: 2 min ago ‚Ä¢ 45 products synced ‚Ä¢ 23 orders in queue
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="syncPrintful()" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">üîÑ Sync Now</button>
                            <button onclick="printfulSettings()" class="bg-indigo-600 hover:bg-indigo-700 px-3 py-1 rounded text-sm">‚öôÔ∏è Settings</button>
                        </div>
                    </div>
                </div>

                <div class="mt-4 flex space-x-2">
                    <button onclick="loadMoreOrders()" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded text-sm">Load More Orders</button>
                    <button onclick="exportData()" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded text-sm">üìä Export Data</button>
                </div>
            </div>

            <!-- AI Assistant Panel -->
            <div class="bg-gray-800 rounded-xl p-6">
                <h3 class="font-semibold mb-3 flex items-center">
                    ü§ñ KinkyBrizzle AI Assistant
                </h3>
                
                <div id="brandChat" class="bg-gray-700 rounded-lg p-4 h-40 overflow-y-auto mb-4">
                    <div class="text-pink-400 mb-2">
                        <strong>KB-AI:</strong> Welcome to KinkyBrizzle! I'm managing 23 active orders and monitoring inventory levels. How can I help you today?
                    </div>
                </div>

                <div class="flex mb-4">
                    <input type="text" id="brandInput" placeholder="Ask AI assistant..." 
                           class="flex-1 bg-gray-600 border border-gray-500 rounded-l-lg px-3 py-2 text-sm focus:outline-none focus:border-pink-500">
                    <button onclick="chatWithBrandAI()" 
                            class="bg-pink-600 hover:bg-pink-700 px-4 py-2 rounded-r-lg text-sm">
                        Send
                    </button>
                </div>

                <!-- Quick Actions -->
                <div class="mt-6">
                    <h3 class="font-semibold mb-3">‚ö° Quick Actions</h3>
                    <div class="space-y-2">
                        <button onclick="processAllOrders()" class="w-full bg-green-600 hover:bg-green-700 py-2 rounded text-sm">
                            ‚ö° Process All Orders
                        </button>
                        <button onclick="updateInventory()" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded text-sm">
                            üì¶ Update Inventory
                        </button>
                        <button onclick="generateReport()" class="w-full bg-purple-600 hover:bg-purple-700 py-2 rounded text-sm">
                            üìä Sales Report
                        </button>
                        <button onclick="customerService()" class="w-full bg-orange-600 hover:bg-orange-700 py-2 rounded text-sm">
                            üí¨ Customer Service
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Printful Integration Dashboard -->
        <div class="mt-8 bg-gray-800 rounded-xl p-6">
            <h2 class="text-xl font-bold mb-4">üè≠ Printful.com Integration Dashboard</h2>
            <div class="grid md:grid-cols-4 gap-4">
                <div class="bg-gradient-to-br from-green-500 to-emerald-600 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold">45</div>
                    <div class="text-sm text-green-100">Products Synced</div>
                </div>
                <div class="bg-gradient-to-br from-blue-500 to-cyan-600 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold">23</div>
                    <div class="text-sm text-blue-100">Orders in Queue</div>
                </div>
                <div class="bg-gradient-to-br from-purple-500 to-violet-600 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold">$2,847</div>
                    <div class="text-sm text-purple-100">Today's Revenue</div>
                </div>
                <div class="bg-gradient-to-br from-orange-500 to-red-600 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold">98.5%</div>
                    <div class="text-sm text-orange-100">Fulfillment Rate</div>
                </div>
            </div>
        </div>

        <!-- AI Workflow Automation -->
        <div class="mt-8 bg-gray-800 rounded-xl p-6">
            <h2 class="text-xl font-bold mb-4">ü§ñ AI Workflow Automation</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold mb-3">üîÑ Active Automations</h3>
                    <div class="space-y-3">
                        <div class="bg-gray-700 rounded-lg p-3 flex items-center justify-between">
                            <div>
                                <div class="font-medium">Auto Order Processing</div>
                                <div class="text-sm text-gray-400">Processes orders under $50 automatically</div>
                            </div>
                            <div class="bg-green-500 w-3 h-3 rounded-full"></div>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3 flex items-center justify-between">
                            <div>
                                <div class="font-medium">Inventory Monitoring</div>
                                <div class="text-sm text-gray-400">Auto-reorder when stock is low</div>
                            </div>
                            <div class="bg-green-500 w-3 h-3 rounded-full"></div>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3 flex items-center justify-between">
                            <div>
                                <div class="font-medium">Customer Support AI</div>
                                <div class="text-sm text-gray-400">24/7 automated customer service</div>
                            </div>
                            <div class="bg-green-500 w-3 h-3 rounded-full"></div>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="font-semibold mb-3">üìà Performance Metrics</h3>
                    <div class="space-y-3">
                        <div class="bg-gray-700 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm">Order Processing Speed</span>
                                <span class="text-sm text-green-400">96%</span>
                            </div>
                            <div class="w-full bg-gray-600 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 96%"></div>
                            </div>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm">Customer Satisfaction</span>
                                <span class="text-sm text-blue-400">94%</span>
                            </div>
                            <div class="w-full bg-gray-600 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 94%"></div>
                            </div>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm">Printful Sync Success</span>
                                <span class="text-sm text-purple-400">99%</span>
                            </div>
                            <div class="w-full bg-gray-600 rounded-full h-2">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: 99%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Back Button -->
        <div class="mt-8 text-center">
            <a href="index.html" class="inline-block bg-gray-700 hover:bg-gray-600 px-6 py-3 rounded-lg font-semibold">
                ‚Üê Back to Office Dashboard
            </a>
        </div>
    </div>

    <script>
        function processOrder(orderId) {
            alert(`üì¶ Processing Order ${orderId}\n\nKB-AI will:\n‚úÖ Validate payment\n‚úÖ Send to Printful for production\n‚úÖ Notify customer of status\n‚úÖ Update inventory\n‚úÖ Generate invoice via Accounts\n\nüéØ Order processed in 15 seconds!`);
        }

        function viewOrderDetails(orderId) {
            alert(`üìã Order Details: ${orderId}\n\nüë§ Customer: Sarah M.\nüìß Email: sarah@example.com\nüè† Address: 123 Main St, City\nüì¶ Items: Premium T-Shirt x2\nüí∞ Total: $45.99\nüìÖ Order Date: Today 10:30 AM\nüéØ Status: Processing`);
        }

        function reorderProduct(productId) {
            alert(`üîÑ Auto-Reordering Product\n\nKB-AI initiating:\nüì¶ Product: Premium Hoodie (Black, L)\nüìä Quantity: 20 units\nüè≠ Printful notification sent\nüí∞ Cost: $240.00\nüìÖ Expected arrival: 3-5 days\n\n‚úÖ Reorder request submitted!`);
        }

        function syncPrintful() {
            alert('üîÑ Printful Sync Initiated\n\nSyncing:\nüì¶ Product catalog\nüìä Inventory levels\nüìã Order status\nüí∞ Pricing updates\n\n‚úÖ Sync completed successfully!\nüïí Next auto-sync: 15 minutes');
        }

        function printfulSettings() {
            alert('‚öôÔ∏è Printful API Settings\n\nConfiguration:\nüîë API Key: Connected\nüè≠ Store ID: KB-Store-001\nüì¶ Auto-fulfill: Enabled\nüí∞ Markup: 150%\nüìß Notifications: Enabled\n\nüéØ All systems operational!');
        }

        function chatWithBrandAI() {
            const input = document.getElementById('brandInput');
            const chat = document.getElementById('brandChat');
            
            if (input.value.trim()) {
                chat.innerHTML += `<div class="text-white mb-2"><strong>You:</strong> ${input.value}</div>`;
                
                // Simulate AI response
                setTimeout(() => {
                    const responses = [
                        "I've analyzed the current order queue - 15 orders ready for immediate processing.",
                        "Inventory alert: 3 products below reorder threshold. Shall I initiate restocking?",
                        "Revenue is up 23% this week! Premium hoodies are the top seller.",
                        "Customer satisfaction score is 94.2%. Two support tickets need attention.",
                        "Printful sync is healthy - 99.1% success rate. All systems operational."
                    ];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    chat.innerHTML += `<div class="text-pink-400 mb-2"><strong>KB-AI:</strong> ${response}</div>`;
                    chat.scrollTop = chat.scrollHeight;
                }, 1000);
                
                input.value = '';
            }
        }

        function processAllOrders() {
            alert('‚ö° Batch Processing All Orders\n\nKB-AI processing:\nüì¶ 23 orders in queue\nüí∞ Total value: $1,247.50\nüè≠ Sending to Printful\nüìß Customer notifications\nüìä Inventory updates\n\nüéØ All orders processed successfully!\n‚è±Ô∏è Average processing time: 12 seconds per order');
        }

        function updateInventory() {
            alert('üì¶ Inventory Update Complete\n\nSynced with Printful:\n‚úÖ 45 products updated\n‚ö†Ô∏è 3 low stock alerts\nüìà 5 trending items identified\nüîÑ 2 auto-reorders initiated\n\nüìä Inventory accuracy: 99.8%');
        }

        function generateReport() {
            alert('üìä Sales Report Generated\n\nüìà This Week:\nüí∞ Revenue: $4,573.20\nüì¶ Orders: 87 completed\nüèÜ Top Product: Premium Hoodie\nüë• New Customers: 23\nüìà Growth: +18% vs last week\n\n‚úÖ Report sent to CEO Office');
        }

        function customerService() {
            alert('üí¨ Customer Service Dashboard\n\nüìß Active Tickets: 4\n‚≠ê Avg Response Time: 12 minutes\nüòä Satisfaction: 94.2%\nü§ñ AI Resolved: 78%\nüë®‚Äçüíº Human Escalation: 22%\n\nüéØ All tickets under control!');
        }

        function showProductCatalog() {
            document.getElementById('managementPanel').innerHTML = `
                <div class="text-center text-gray-400 py-8">
                    üõçÔ∏è Product Catalog View<br>
                    45 active products ‚Ä¢ 12 variants each<br>
                    <button onclick="location.reload()" class="mt-4 bg-pink-600 px-4 py-2 rounded">Back to Orders</button>
                </div>
            `;
        }

        function showOrderQueue() {
            location.reload(); // Reset to default order view
        }

        function showInventory() {
            document.getElementById('managementPanel').innerHTML = `
                <div class="text-center text-gray-400 py-8">
                    üì¶ Inventory Management View<br>
                    3 items need reordering ‚Ä¢ 98.5% in stock<br>
                    <button onclick="location.reload()" class="mt-4 bg-pink-600 px-4 py-2 rounded">Back to Orders</button>
                </div>
            `;
        }

        function loadMoreOrders() {
            alert('üì¨ Loaded 10 additional orders\nüì¶ 15 processing\n‚úÖ 8 completed\n‚è≥ 2 pending payment\n\nAll sorted by priority and urgency!');
        }

        function exportData() {
            alert('üìä Data Export Complete\n\nExported:\nüì¶ Order history (last 30 days)\nüí∞ Revenue analytics\nüìà Product performance\nüë• Customer data\n\n‚úÖ CSV files ready for download');
        }

        // Enter key support
        document.getElementById('brandInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                chatWithBrandAI();
            }
        });

        // Load real data from backend
        async function loadBrandData() {
            try {
                const response = await fetch('https://mydxasjicsfetnglbppp.supabase.co/functions/v1/kinky-brizzle/status');
                const data = await response.json();
                if (data.success && data.statistics) {
                    document.getElementById('activeOrders').textContent = data.statistics.active_orders || 23;
                }
            } catch (error) {
                console.log('Using simulated data');
            }
        }

        loadBrandData();
    </script>

<!-- GLOBAL CRM SETUP PAYLOAD FOR COPILOT DEPLOYMENT -->
<!-- DROP THIS INTO COPILOT AND DEPLOY ACROSS ALL HTML FILES -->
<!-- REPLACES GOOGLE AUTH, SUPERBASE CONNECTION, AND BACKEND SYNC -->

<!-- üß† LOAD RUBE CHATBOT WITH VOICE MAPPING -->
<script src="https://rube.app/embed/chat?agent=ellie-ai&apikey=eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOiJ1c2VyXzAxSzUyNDJUVllBTlBNTjIxTVdZWUtBVlk1Iiwib3JnSWQiOiJvcmdfMDFLNTI0MzI5TVkxOFo5SlhQQTJKM1kxOVkiLCJpYXQiOjE3NTkwNzMzNjB9.dlelFFUO-TRCVA4Q7d4n5xArhN5sxCBBm4VLFxmaMZM"></script>
<script>
  const officeName = document.title || "CEO Office";
  const voiceMap = {
    "CEO Office": "Brian",
    "Admin Mailroom": "Stacy",
    "Logistics Office": "Ellie",
    "Accounts Office": "Ava",
    "Virtual Engineer": "Riley",
    "Therapy Room": "Luna"
  };
  window.addEventListener("load", () => {
    const aiAgent = document.querySelector("[rube-chat-agent]");
    if (aiAgent && voiceMap[officeName]) {
      aiAgent.setAttribute("voice", voiceMap[officeName]);
    }
  });
</script>

<!-- üîë SUPERBASE GLOBAL CONNECTION -->
<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
  window.supabase = createClient(
    'https://mydxasjicsfetnglbppp.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15ZHhhc2ppY3NmZXRuZ2xicHBwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyMjYyNTQsImV4cCI6MjA3MzgwMjI1NH0.zdJa3T1WDdc6_JNQbh93oB7CnVWa5TQ5jLb1UN-8dLE'
  );
</script>

<!-- ‚úÖ GOOGLE SIGN-IN SYSTEM -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script>
  window.onload = () => {
    google.accounts.id.initialize({
      client_id: "624596716963-huc2ef9rt7q8vckvjtbr84tfrjbs5cic.apps.googleusercontent.com",
      callback: handleCredentialResponse
    });
    google.accounts.id.renderButton(
      document.getElementById("gSignIn"),
      { theme: "outline", size: "large" }
    );
    google.accounts.id.prompt();
  };

  async function handleCredentialResponse(response) {
    const userData = parseJwt(response.credential);
    if (userData.email === "ian@ishe-ltd.co.uk") {
      localStorage.setItem("user", JSON.stringify(userData));
      window.location.href = "boss-office.html";
    } else {
      alert("Access Denied: Not authorised");
    }
  }

  function parseJwt(token) {
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const jsonPayload = decodeURIComponent(
      atob(base64)
        .split('')
        .map(c => `%${('00' + c.charCodeAt(0).toString(16)).slice(-2)}`)
        .join('')
    );
    return JSON.parse(jsonPayload);
  }
</script>

<!-- üîê LOGIN.HTML PLACEHOLDER -->
<div id="gSignIn" class="flex justify-center mt-8"></div>

<!-- Google OAuth Login Handler -->
<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'
  const supabase = createClient(
    'https://mydxasjcsfetnglbppp.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15ZHhhc2ppY3NmZXRuZ2xicHBwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyMjYyNTQsImV4cCI6MjA3MzgwMjI1NH0.zdJa3T1WDdc6_JNQbh93oB7CnVWa5TQ5jLb1UN-8dLE'
  )
  const loginBtn = document.querySelector('#login-button')
  loginBtn.addEventListener('click', async () => {
    const { error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
    })
    if (error) console.error('Login error:', error.message)
  })
</script>

</body>
</html>